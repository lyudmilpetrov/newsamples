(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{pgxD:function(e,t,n){"use strict";n.r(t),n.d(t,"FaceLoginModule",(function(){return U}));var o=n("3Pt+"),a=n("ofXK"),i=n("tyNb"),s=n("S0DU"),r=n("fXoL"),c=n("0IaG"),l=n("kmnG"),d=n("qFsG"),h=n("d3UM"),m=n("FKr1");let p=(()=>{class e{constructor(e,t,n,a){this.data=t,this.dialogRef=n,this.ngZone=a,this.form=new o.f({username:new o.d(""),password:new o.d("")}),this.submitEM=new r.o,this.message="Are you sure?",this.confirmButtonText="Close",this.cancelButtonText="Cancel",this.ngZone.run(()=>{t&&(this.message=t.message||this.message)})}onConfirmClick(){console.log("Close now"),this.ngZone.run(()=>{this.dialogRef.close("some info here")})}submit(){this.form.valid&&this.submitEM.emit(this.form.value)}}return e.\u0275fac=function(t){return new(t||e)(r.Mb(e,12),r.Mb(c.a),r.Mb(c.f),r.Mb(r.B))},e.\u0275cmp=r.Gb({type:e,selectors:[["app-login-form"]],outputs:{submitEM:"submitEM"},decls:10,vars:0,consts:[[2,"min-width","50vw !important"],["matInput","","placeholder","Enter name"],["matInput","","placeholder","Textarea"],["placeholder","Select"],["value","option"]],template:function(e,t){1&e&&(r.Sb(0,"mat-form-field",0),r.Nb(1,"input",1),r.Rb(),r.Nb(2,"br"),r.Sb(3,"mat-form-field"),r.Nb(4,"textarea",2),r.Rb(),r.Nb(5,"br"),r.Sb(6,"mat-form-field"),r.Sb(7,"mat-select",3),r.Sb(8,"mat-option",4),r.Cc(9,"Option"),r.Rb(),r.Rb(),r.Rb())},directives:[l.c,d.b,h.a,m.m],encapsulation:2}),e})();var g=n("qzk7"),b=n("XBjD"),u=n("42F4"),f=n("dNgK"),w=n("tk/3"),v=n("XiUz"),C=n("Wp6s"),M=n("NFeN"),x=n("bTqV"),P=n("7EHt");const S=["video"],R=["canvasLast"],E=["canvasPrior"];function O(e,t){1&e&&(r.Sb(0,"mat-error"),r.Cc(1," You must provide the "),r.Sb(2,"strong"),r.Cc(3," user name"),r.Rb(),r.Rb())}function F(e,t){1&e&&(r.Sb(0,"mat-error"),r.Cc(1," It must start with a "),r.Sb(2,"strong"),r.Cc(3," letter"),r.Rb(),r.Rb())}function L(e,t){1&e&&(r.Sb(0,"mat-error"),r.Cc(1," You must provide the "),r.Sb(2,"strong"),r.Cc(3," password"),r.Rb(),r.Rb())}function y(e,t){if(1&e&&(r.Sb(0,"mat-error"),r.Cc(1," It contains "),r.Sb(2,"strong"),r.Cc(3," restricted "),r.Rb(),r.Cc(4),r.Rb()),2&e){const e=r.ec(2);r.Bb(4),r.Ec(" word - ",null==e.password.errors?null:e.password.errors.restrictedWords," ")}}function _(e,t){if(1&e){const e=r.Tb();r.Sb(0,"div",2),r.Sb(1,"mat-card",3),r.Sb(2,"mat-card-header"),r.Sb(3,"mat-card-title"),r.Cc(4,"Log in"),r.Rb(),r.Rb(),r.Sb(5,"form",4),r.Sb(6,"mat-card-content"),r.Sb(7,"mat-form-field",5),r.Nb(8,"input",6),r.Bc(9,O,4,0,"mat-error",1),r.Bc(10,F,4,0,"mat-error",1),r.Rb(),r.Sb(11,"mat-form-field",5),r.Nb(12,"input",7),r.Sb(13,"mat-icon",8),r.ac("click",(function(){r.tc(e);const t=r.ec();return t.hidePassword=!t.hidePassword})),r.Cc(14),r.Rb(),r.Bc(15,L,4,0,"mat-error",1),r.Bc(16,y,5,1,"mat-error",1),r.Rb(),r.Rb(),r.Sb(17,"button",9),r.ac("click",(function(){r.tc(e);const t=r.ec();return t.loginWithPassword(t.profileForm.value)})),r.Cc(18,"Log in with password"),r.Rb(),r.Sb(19,"button",10),r.ac("click",(function(){r.tc(e);const t=r.ec();return t.loginWithFace(t.profileForm.value)})),r.Cc(20,"Log in with face"),r.Rb(),r.Rb(),r.Rb(),r.Rb()}if(2&e){const e=r.ec();r.Bb(5),r.jc("formGroup",e.profileForm),r.Bb(4),r.jc("ngIf",e.errorHandling("username","required")),r.Bb(1),r.jc("ngIf",null==e.username.errors?null:e.username.errors.pattern),r.Bb(2),r.jc("type",e.hidePassword?"password":"text"),r.Bb(2),r.Dc(e.hidePassword?"visibility_off":"visibility"),r.Bb(1),r.jc("ngIf",e.errorHandling("password","required")),r.Bb(1),r.jc("ngIf",null==e.password.errors?null:e.password.errors.restrictedWords)}}function k(e,t){if(1&e){const e=r.Tb();r.Sb(0,"mat-accordion"),r.Sb(1,"mat-expansion-panel",11),r.Sb(2,"mat-expansion-panel-header"),r.Sb(3,"mat-panel-title"),r.Cc(4," This is the expansion title "),r.Rb(),r.Sb(5,"mat-panel-description"),r.Cc(6," This is a summary of the content "),r.Rb(),r.Rb(),r.Sb(7,"p"),r.Cc(8,"This is the primary content of the panel."),r.Rb(),r.Rb(),r.Sb(9,"mat-expansion-panel",12),r.ac("opened",(function(){return r.tc(e),r.ec().panelOpenState=!0}))("closed",(function(){return r.tc(e),r.ec().panelOpenState=!1})),r.Sb(10,"mat-expansion-panel-header"),r.Sb(11,"mat-panel-title"),r.Cc(12," Self aware panel "),r.Rb(),r.Sb(13,"mat-panel-description"),r.Cc(14),r.Rb(),r.Rb(),r.Sb(15,"p"),r.Cc(16),r.Rb(),r.Rb(),r.Rb()}if(2&e){const e=r.ec();r.Bb(14),r.Ec(" ",e.panelOpenState?"Opened":"Closed"," "),r.Bb(2),r.Ec("Welcome ",e.currentUserName,"")}}const I=[{path:"",component:(()=>{class e{constructor(e,t,n,a,i,s,r){var c;this.toastr=e,this.renderer=t,this.os=n,this.dialog=a,this.snackBar=i,this.httpClient=s,this.ngZone=r,this.MODEL_URL="../../assets/weights",this.constraints={audio:!1,video:{facingMode:"selfie",width:{ideal:4096},height:{ideal:2160}}},this.mtcnnForwardParams={minFaceSize:200,scaleFactor:.709,maxNumScales:10,scoreThresholds:[.6,.7,.7]},this.videoWidth=0,this.videoHeight=0,this.result=0,this.valueInput="",this.images=[],this.matched="These faces belong to different people!",this.maxDescriptorDistance=.4,this.IsWait=!1,this.switchimage=1,this.username=new o.d("",[o.q.required,o.q.pattern("[a-zA-Z].*")]),this.password=new o.d("",[o.q.required,(c=["test","bar"],e=>{if(c){const t=c.map(t=>e.value.includes(t)?t:null).filter(e=>null!=e);return t&&t.length>0?{restrictedWords:t.join(", ")}:null}return null})]),this.profileForm=new o.f({username:this.username,password:this.password}),this.hideLoginForm=!1,this.hidePassword=!0,this.panelOpenState=!1,this.currentUserName="",this.errorHandling=(e,t)=>this.profileForm.controls[e].hasError(t),Promise.all([this.loadF(this.MODEL_URL,"loadSsdMobilenetv1Model").then(e=>{console.log(e)}).catch(e=>{console.log(e)}).finally(()=>{console.log("done")}),this.loadF(this.MODEL_URL,"loadFaceDetectionModel").then(e=>{console.log(e)}).catch(e=>{console.log(e)}).finally(()=>{console.log("done")}),this.loadF(this.MODEL_URL,"loadFaceLandmarkModel").then(e=>{console.log(e)}).catch(e=>{console.log(e)}).finally(()=>{console.log("done")}),this.loadF(this.MODEL_URL,"loadFaceRecognitionModel").then(e=>{console.log(e)}).catch(e=>{console.log(e)}).finally(()=>{console.log("done")})]).then(e=>{console.log(e)}).catch(e=>console.log(e)).finally(()=>{console.log("done loading"),console.log(g)})}ngOnInit(){this.toastr.options.positionClass="toast-top-center",this.toastr.success("open now","title"),console.log(g),this.breakpoint=window.innerWidth<=400?1:2}loginWithPassword(e){if(console.log(e),this.profileForm.valid&&e.username.replace(/ +/g," ").length>=1&&e.password.replace(/ +/g," ").length){const t={username:e.username,password:e.password};this.currentUserName=e.username,this.os.setCache("localStorage",e.username.replace(/ +/g," "),t,"object"),this.hideLoginForm=!0}}loginWithFace(e){console.log(e)}openLoginForm(e){this.dialog.open(p,{width:"60vw",maxWidth:"60vw",height:"60vh",maxHeight:"60vh",data:{message:e,buttonText:{ok:"Save",cancel:"No"}}}).afterClosed().subscribe(e=>{console.log(e)})}onResize(e){this.breakpoint=e.target.innerWidth<=4?1:2}async loadF(e,t){await g[t](e)}handleError(e){console.log("Error: ",e)}attachVideo(e){this.renderer.setProperty(this.videoElement.nativeElement,"srcObject",e),this.renderer.listen(this.videoElement.nativeElement,"play",e=>{this.videoHeight=this.videoElement.nativeElement.videoHeight,this.videoWidth=this.videoElement.nativeElement.videoWidth})}startCamera(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(this.constraints).then(this.attachVideo.bind(this)).catch(this.handleError):alert("Camera not available.")}captureImageFirst(){this.renderer.setProperty(this.canvasLast.nativeElement,"width",this.videoWidth),this.renderer.setProperty(this.canvasLast.nativeElement,"height",this.videoHeight),this.canvasLast.nativeElement.getContext("2d").drawImage(this.videoElement.nativeElement,0,0)}captureImageSecond(){this.renderer.setProperty(this.canvasPrior.nativeElement,"width",this.videoWidth),this.renderer.setProperty(this.canvasPrior.nativeElement,"height",this.videoHeight),this.canvasPrior.nativeElement.getContext("2d").drawImage(this.videoElement.nativeElement,0,0)}capture(){1===this.switchimage?(this.switchimage=2,this.captureImageFirst()):(this.switchimage=1,this.captureImageSecond())}async compareImages(){this.IsWait=!0,this.ngZone.run(()=>{this.IsWait=!0});const e=await this.computeSingleFaceDescriptors(this.canvasLast.nativeElement,this.canvasPrior.nativeElement,"Lyudmil",this.videoHeight,this.videoWidth);console.log(e),e<=this.maxDescriptorDistance?(this.matched="The faces belong to one person!",this.openDialog(this.matched),this.IsWait=!1):(this.matched="It is hard to tell if that is the same person!",this.openDialog(this.matched),this.IsWait=!1)}async computeSingleFaceDescriptors(e,t,n,o,a){const i={width:a,height:o};let s=1,r=await g.detectSingleFace(e).withFaceLandmarks().withFaceDescriptor();r=g.resizeResults(r,i);let c=await g.detectSingleFace(t).withFaceLandmarks().withFaceDescriptor();c=g.resizeResults(c,i),void 0!==r&&(g.draw.drawDetections(e,r),g.draw.drawFaceLandmarks(e,r)),void 0!==c&&(g.draw.drawDetections(t,c),g.draw.drawFaceLandmarks(t,c)),console.log([r.descriptor]);const l=[c.descriptor];console.log(l);const d=new g.LabeledFaceDescriptors("Prior",l),h=new g.FaceMatcher(d,this.maxDescriptorDistance);return s=[r].map(e=>h.findBestMatch(e.descriptor))[0]._distance,s}openDialog(e){this.dialog.open(s.a,{data:{message:e,buttonText:{ok:"Save",cancel:"No"}}}).afterClosed().subscribe(e=>{console.log(e)})}onFileComplete(e){console.log(e);const t=new Image;t.src=e.result,t.onload=()=>{let e=t.naturalWidth;const n=this.canvasLast.nativeElement.width;let o=1;e>n&&(o=n/e);let a=t.naturalHeight;const i=this.canvasLast.nativeElement.height;let s=1;a>i&&(s=i/a);let r=s;o<s&&(r=o),r<1&&(a*=r,e*=r),this.canvasLast.nativeElement.height=a,this.canvasLast.nativeElement.width=e,this.canvasLast.nativeElement.getContext("2d").drawImage(t,0,0,t.naturalWidth,t.naturalHeight,0,0,e,a)}}clearFirst(){const e=this.canvasLast.nativeElement.getContext("2d");e.clearRect(0,0,e.canvas.width,e.canvas.height),e.restore()}clearSecond(){const e=this.canvasPrior.nativeElement.getContext("2d");e.clearRect(0,0,e.canvas.width,e.canvas.height),e.restore()}}return e.\u0275fac=function(t){return new(t||e)(r.Mb(b.a),r.Mb(r.G),r.Mb(u.b),r.Mb(c.b),r.Mb(f.a),r.Mb(w.a),r.Mb(r.B))},e.\u0275cmp=r.Gb({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&(r.xc(S,!0),r.xc(R,!0),r.xc(E,!0)),2&e){let e;r.pc(e=r.bc())&&(t.videoElement=e.first),r.pc(e=r.bc())&&(t.canvasLast=e.first),r.pc(e=r.bc())&&(t.canvasPrior=e.first)}},decls:2,vars:2,consts:[["class","login-wrapper","fxLayout","row","fxLayoutAlign","center center",4,"ngIf"],[4,"ngIf"],["fxLayout","row","fxLayoutAlign","center center",1,"login-wrapper"],[1,"box"],["autocomplete","off","novalidate","",1,"example-form",3,"formGroup"],[1,"example-full-width"],["matInput","","formControlName","username","placeholder","Username"],["matInput","","placeholder","Password","formControlName","password","required","",3,"type"],["matSuffix","",3,"click"],["mat-stroked-button","","color","accent",1,"btn",2,"float","left",3,"click"],["mat-stroked-button","","color","accent",1,"btn",2,"float","right",3,"click"],["hideToggle",""],[3,"opened","closed"]],template:function(e,t){1&e&&(r.Bc(0,_,21,7,"div",0),r.Bc(1,k,17,2,"mat-accordion",1)),2&e&&(r.jc("ngIf",!t.hideLoginForm),r.Bb(1),r.jc("ngIf",t.hideLoginForm))},directives:[a.k,v.b,v.a,C.a,C.d,C.g,o.r,o.m,o.g,C.c,l.c,d.b,o.c,o.l,o.e,o.p,M.a,l.f,x.a,l.b,P.a,P.c,P.e,P.f,P.d],styles:['.login-wrapper[_ngcontent-%COMP%]{height:100%}.positronx[_ngcontent-%COMP%]{text-decoration:none;color:#b81d1d}.box[_ngcontent-%COMP%]{position:relative;top:0;opacity:1;float:left;width:100%;background:#8a88fb;border-radius:10px;transform:scale(1);-webkit-transform:scale(1);-ms-transform:scale(1);z-index:5;max-width:330px}.box.back[_ngcontent-%COMP%]{top:-20px;opacity:.8}.box.back[_ngcontent-%COMP%], .box[_ngcontent-%COMP%]:before{transform:scale(.95);-webkit-transform:scale(.95);-ms-transform:scale(.95);z-index:-1}.box[_ngcontent-%COMP%]:before{content:"";position:absolute;background:hsla(0,0%,100%,.6);left:0}.login-wrapper[_ngcontent-%COMP%]   .example-form[_ngcontent-%COMP%]{min-width:100%;max-width:300px;width:100%}.login-wrapper[_ngcontent-%COMP%]   .btn-block[_ngcontent-%COMP%], .login-wrapper[_ngcontent-%COMP%]   .example-full-width[_ngcontent-%COMP%]{width:100%}.login-wrapper[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{text-align:center;width:100%;display:block;font-weight:700}.login-wrapper[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:30px;margin:0}.login-wrapper[_ngcontent-%COMP%]   .mat-card[_ngcontent-%COMP%]{padding:40px 70px 50px}.login-wrapper[_ngcontent-%COMP%]   .mat-stroked-button[_ngcontent-%COMP%]{border:1px solid;line-height:54px;background:#e70d5d}.login-wrapper[_ngcontent-%COMP%]   .mat-form-field-appearance-legacy[_ngcontent-%COMP%]   .mat-form-field-infix[_ngcontent-%COMP%]{padding:.8375em 0}.vid[_ngcontent-%COMP%]{width:100%;height:100%}.mat-chip[_ngcontent-%COMP%]{justify-content:space-between}.pointer[_ngcontent-%COMP%]{cursor:pointer}.center[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translateX(-50%) translateY(-50%)}.overlay[_ngcontent-%COMP%]{height:100vh;width:100%;background-color:rgba(0,0,0,.286);z-index:10;top:0;left:0;position:fixed;background:#000;opacity:.75!important}body[_ngcontent-%COMP%]{margin:0}.close-right[_ngcontent-%COMP%]{cursor:pointer;position:absolute;right:0;margin-right:10px}.toast-top-center[_ngcontent-%COMP%]{left:50%}']}),e})()}];var D=n("5dmV"),W=n("Q92/"),B=n("NyRW"),N=n("X5Wf"),T=n("YUcS");let U=(()=>{class e{}return e.\u0275mod=r.Kb({type:e}),e.\u0275inj=r.Jb({factory:function(t){return new(t||e)},providers:[u.b],imports:[[i.e.forChild(I),o.o,o.h,a.c,D.a,W.a,B.a,N.a,T.a]]}),e})()}}]);